(grepl("RAPE", prison$Most.Serious.Crime) |
grepl("CRIM SEX ACT", prison$Most.Serious.Crime) |
grepl("SEX", prison$Most.Serious.Crime) |
grepl("PORN", prison$Most.Serious.Crime) |
grepl("PROSTI", prison$Most.Serious.Crime) |
grepl("INDEC", prison$Most.Serious.Crime) |
grepl("SODOMY", prison$Most.Serious.Crime)) == "TRUE" ~ "Sexual Crime" ,
(grepl("BURGLARY", prison$Most.Serious.Crime) |
grepl("LARCEN", prison$Most.Serious.Crime) |
grepl("STOLEN", prison$Most.Serious.Crime) |
grepl("ROBBERY", prison$Most.Serious.Crime)) == "TRUE" ~ "Stealing",
TRUE ~ as.character(prison$Most.Serious.Crime)
)
length(unique(prison$Crime.Category))
unique(prison$Crime.Category)
prison$Most.Serious.Crime %>%
View()
prison$Crime.Category <- case_when(
grepl("MURDER", prison$Most.Serious.Crime) == "TRUE" ~ "Murder",
grepl("FORGE", prison$Most.Serious.Crime) == "TRUE" ~ "Forgery",
grepl("ASSAULT", prison$Most.Serious.Crime) == "TRUE" ~ "Assault",
grepl("ARSON", prison$Most.Serious.Crime) == "TRUE" ~ "Arson",
grepl("MANSLAUG", prison$Most.Serious.Crime) == "TRUE" ~ "Manslaughter",
grepl("CONTEMPT", prison$Most.Serious.Crime) == "TRUE" ~ "Contempt",
grepl("CONSPIRACY", prison$Most.Serious.Crime) == "TRUE" ~ "Conspiracy",
grepl("TAX", prison$Most.Serious.Crime) == "TRUE" ~ "Tax Related",
grepl("STRANGUL", prison$Most.Serious.Crime) == "TRUE" ~ "Strangulation",
grepl("BAIL", prison$Most.Serious.Crime) == "TRUE" ~ "Bail Related",
grepl("MISCHIEF", prison$Most.Serious.Crime) == "TRUE" ~ "Criminal Mischief",
grepl("KIDNAPPING", prison$Most.Serious.Crime) == "TRUE" ~ "Kidnapping",
grepl("COERC", prison$Most.Serious.Crime) == "TRUE" ~ "Coercion",
# Weapons
(grepl("WEAP", prison$Most.Serious.Crime) |
grepl("FIREARM", prison$Most.Serious.Crime)) == "TRUE" ~ "Weapon Related",
# Fraud, identity theft
(grepl("IDENTITY THEFT", prison$Most.Serious.Crime) |
grepl("FRAUD", prison$Most.Serious.Crime)) == "TRUE" ~ "Fraud",
# Drug Related
(grepl("CPCS", prison$Most.Serious.Crime) |
grepl("DRUG", prison$Most.Serious.Crime) |
grepl("MARI", prison$Most.Serious.Crime) |
grepl("DRGS", prison$Most.Serious.Crime) |
grepl("CONTROLLED", prison$Most.Serious.Crime) |
grepl("METH", prison$Most.Serious.Crime) |
grepl("CSCS", prison$Most.Serious.Crime)) == "TRUE" ~ "Drug Related",
(grepl("IMPAIR", prison$Most.Serious.Crime) |
grepl("INTOX", prison$Most.Serious.Crime) |
grepl("DWI", prison$Most.Serious.Crime)) == "TRUE" ~ "DUI",
(grepl("RAPE", prison$Most.Serious.Crime) |
grepl("CRIM SEX ACT", prison$Most.Serious.Crime) |
grepl("SEX", prison$Most.Serious.Crime) |
grepl("PORN", prison$Most.Serious.Crime) |
grepl("PROSTI", prison$Most.Serious.Crime) |
grepl("INDEC", prison$Most.Serious.Crime) |
grepl("SODOMY", prison$Most.Serious.Crime)) == "TRUE" ~ "Sexual Crime" ,
(grepl("BURGLARY", prison$Most.Serious.Crime) |
grepl("LARCEN", prison$Most.Serious.Crime) |
grepl("STOLEN", prison$Most.Serious.Crime) |
grepl("ROBBERY", prison$Most.Serious.Crime)) == "TRUE" ~ "Stealing",
TRUE ~ as.character(prison$Most.Serious.Crime)
)
prison$Crime.Category <- case_when(
grepl("MURDER", prison$Most.Serious.Crime) == "TRUE" ~ "Murder",
grepl("FORGE", prison$Most.Serious.Crime) == "TRUE" ~ "Forgery",
grepl("ASSAULT", prison$Most.Serious.Crime) == "TRUE" ~ "Assault",
grepl("ARSON", prison$Most.Serious.Crime) == "TRUE" ~ "Arson",
grepl("MANSLAUG", prison$Most.Serious.Crime) == "TRUE" ~ "Manslaughter",
grepl("CONTEMPT", prison$Most.Serious.Crime) == "TRUE" ~ "Contempt",
grepl("CONSPIRACY", prison$Most.Serious.Crime) == "TRUE" ~ "Conspiracy",
grepl("TAX", prison$Most.Serious.Crime) == "TRUE" ~ "Tax Related",
grepl("STRANGUL", prison$Most.Serious.Crime) == "TRUE" ~ "Strangulation",
grepl("BAIL", prison$Most.Serious.Crime) == "TRUE" ~ "Bail Related",
grepl("MISCHIEF", prison$Most.Serious.Crime) == "TRUE" ~ "Criminal Mischief",
grepl("KIDNAPPING", prison$Most.Serious.Crime) == "TRUE" ~ "Kidnapping",
grepl("COERC", prison$Most.Serious.Crime) == "TRUE" ~ "Coercion",
# Weapons
(grepl("WEAP", prison$Most.Serious.Crime) |
grepl("FIREARM", prison$Most.Serious.Crime)) == "TRUE" ~ "Weapon Related",
# Fraud, identity theft
(grepl("IDENTITY THEFT", prison$Most.Serious.Crime) |
grepl("FRAUD", prison$Most.Serious.Crime)) == "TRUE" ~ "Fraud",
# Drug Related
(grepl("CPCS", prison$Most.Serious.Crime) |
grepl("DRUG", prison$Most.Serious.Crime) |
grepl("MARI", prison$Most.Serious.Crime) |
grepl("DRGS", prison$Most.Serious.Crime) |
grepl("CONTROLLED", prison$Most.Serious.Crime) |
grepl("METH", prison$Most.Serious.Crime) |
grepl("CSCS", prison$Most.Serious.Crime)) == "TRUE" ~ "Drug Related",
(grepl("IMPAIR", prison$Most.Serious.Crime) |
grepl("INTOX", prison$Most.Serious.Crime) |
grepl("DWI", prison$Most.Serious.Crime)) == "TRUE" ~ "DUI",
(grepl("RAPE", prison$Most.Serious.Crime) |
grepl("CRIM SEX ACT", prison$Most.Serious.Crime) |
grepl("SEX", prison$Most.Serious.Crime) |
grepl("PORN", prison$Most.Serious.Crime) |
grepl("PROSTI", prison$Most.Serious.Crime) |
grepl("INDEC", prison$Most.Serious.Crime) |
grepl("SODOMY", prison$Most.Serious.Crime)) == "TRUE" ~ "Sexual Crime" ,
(grepl("BURGLARY", prison$Most.Serious.Crime) |
grepl("LARCEN", prison$Most.Serious.Crime) |
grepl("STOLEN", prison$Most.Serious.Crime) |
grepl("ROBBERY", prison$Most.Serious.Crime)) == "TRUE" ~ "Stealing",
TRUE ~ as.character(prison$Most.Serious.Crime)
)
length(unique(prison$Crime.Category))
unique(prison$Crime.Category)
grepl("MANSLAUG", prison$Most.Serious.Crime) == "TRUE" ~ "Manslaughter",
prison$Crime.Category
prison$Crime.Category
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n())
crimesummary <-
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n())
crimesummary <-
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
view
crimesummary <-
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count))
crimesummary
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
head(20)
prison$Crime.Category <- case_when(
grepl("MURDER", prison$Most.Serious.Crime) == "TRUE" ~ "Murder",
grepl("MURDER", prison$Most.Serious.Crime) == "TRUE" ~ "Murder",
grepl("FORGE", prison$Most.Serious.Crime) == "TRUE" ~ "Forgery",
grepl("ASSAULT", prison$Most.Serious.Crime) == "TRUE" ~ "Assault",
grepl("ARSON", prison$Most.Serious.Crime) == "TRUE" ~ "Arson",
grepl("MANSLAUG", prison$Most.Serious.Crime) == "TRUE" ~ "Manslaughter",
grepl("CONTEMPT", prison$Most.Serious.Crime) == "TRUE" ~ "Contempt",
grepl("CONSPIRACY", prison$Most.Serious.Crime) == "TRUE" ~ "Conspiracy",
grepl("TAX", prison$Most.Serious.Crime) == "TRUE" ~ "Tax Related",
grepl("STRANGUL", prison$Most.Serious.Crime) == "TRUE" ~ "Strangulation",
grepl("BAIL", prison$Most.Serious.Crime) == "TRUE" ~ "Bail Related",
grepl("MISCHIEF", prison$Most.Serious.Crime) == "TRUE" ~ "Criminal Mischief",
grepl("KIDNAPPING", prison$Most.Serious.Crime) == "TRUE" ~ "Kidnapping",
grepl("COERC", prison$Most.Serious.Crime) == "TRUE" ~ "Coercion",
# Weapons
(grepl("WEAP", prison$Most.Serious.Crime) |
grepl("FIREARM", prison$Most.Serious.Crime)) == "TRUE" ~ "Weapon Related",
# Fraud, identity theft
(grepl("IDENTITY THEFT", prison$Most.Serious.Crime) |
grepl("FRAUD", prison$Most.Serious.Crime)) == "TRUE" ~ "Fraud",
# Drug Related
(grepl("CPCS", prison$Most.Serious.Crime) |
grepl("DRUG", prison$Most.Serious.Crime) |
grepl("MARI", prison$Most.Serious.Crime) |
grepl("DRGS", prison$Most.Serious.Crime) |
grepl("CONTROLLED", prison$Most.Serious.Crime) |
grepl("METH", prison$Most.Serious.Crime) |
grepl("CSCS", prison$Most.Serious.Crime)) == "TRUE" ~ "Drug Related",
(grepl("IMPAIR", prison$Most.Serious.Crime) |
grepl("INTOX", prison$Most.Serious.Crime) |
grepl("DWI", prison$Most.Serious.Crime)) == "TRUE" ~ "DUI",
(grepl("RAPE", prison$Most.Serious.Crime) |
grepl("CRIM SEX ACT", prison$Most.Serious.Crime) |
grepl("SEX", prison$Most.Serious.Crime) |
grepl("PORN", prison$Most.Serious.Crime) |
grepl("PROSTI", prison$Most.Serious.Crime) |
grepl("INDEC", prison$Most.Serious.Crime) |
grepl("SODOMY", prison$Most.Serious.Crime)) == "TRUE" ~ "Sexual Crime" ,
(grepl("BURGLARY", prison$Most.Serious.Crime) |
grepl("LARCEN", prison$Most.Serious.Crime) |
grepl("LAR", prison$Most.Serious.Crime) |
grepl("STOLEN", prison$Most.Serious.Crime) |
grepl("ROBBERY", prison$Most.Serious.Crime)) == "TRUE" ~ "Theft",
TRUE ~ as.character(prison$Most.Serious.Crime)
)
crimesummary <-
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
head(20)
crimesummary
prison$Crime.Category <- case_when(
grepl("MURDER", prison$Most.Serious.Crime) == "TRUE" ~ "Murder",
grepl("MURDER", prison$Most.Serious.Crime) == "TRUE" ~ "Murder",
grepl("FORGE", prison$Most.Serious.Crime) == "TRUE" ~ "Forgery",
grepl("ASSAULT", prison$Most.Serious.Crime) == "TRUE" ~ "Assault",
grepl("ARSON", prison$Most.Serious.Crime) == "TRUE" ~ "Arson",
grepl("MANSLAUG", prison$Most.Serious.Crime) == "TRUE" ~ "Manslaughter",
grepl("CONTEMPT", prison$Most.Serious.Crime) == "TRUE" ~ "Contempt",
grepl("CONSPIRACY", prison$Most.Serious.Crime) == "TRUE" ~ "Conspiracy",
grepl("TAX", prison$Most.Serious.Crime) == "TRUE" ~ "Tax Related",
grepl("STRANGUL", prison$Most.Serious.Crime) == "TRUE" ~ "Strangulation",
grepl("BAIL", prison$Most.Serious.Crime) == "TRUE" ~ "Bail Related",
grepl("MISCHIEF", prison$Most.Serious.Crime) == "TRUE" ~ "Criminal Mischief",
grepl("KIDNAPPING", prison$Most.Serious.Crime) == "TRUE" ~ "Kidnapping",
grepl("COERC", prison$Most.Serious.Crime) == "TRUE" ~ "Coercion",
grepl("RECK ENDANG", prison$Most.Serious.Crime) == "TRUE" ~ "Reckless Endangerment",
grepl("UNLICENSED D", prison$Most.Serious.Crime) == "TRUE" ~ "Unlicensed Driver",
grepl("CONTRAB", prison$Most.Serious.Crime) == "TRUE" ~ "Contraband Possession",
# Weapons
(grepl("WEAP", prison$Most.Serious.Crime) |
grepl("FIREARM", prison$Most.Serious.Crime)) == "TRUE" ~ "Weapon Related",
# Fraud, identity theft
(grepl("IDENTITY THEFT", prison$Most.Serious.Crime) |
grepl("FRAUD", prison$Most.Serious.Crime)) == "TRUE" ~ "Fraud",
# Drug Related
(grepl("CPCS", prison$Most.Serious.Crime) |
grepl("DRUG", prison$Most.Serious.Crime) |
grepl("MARI", prison$Most.Serious.Crime) |
grepl("DRGS", prison$Most.Serious.Crime) |
grepl("CONTROLLED", prison$Most.Serious.Crime) |
grepl("METH", prison$Most.Serious.Crime) |
grepl("CSCS", prison$Most.Serious.Crime)) == "TRUE" ~ "Drug Related",
(grepl("IMPAIR", prison$Most.Serious.Crime) |
grepl("INTOX", prison$Most.Serious.Crime) |
grepl("DWI", prison$Most.Serious.Crime)) == "TRUE" ~ "DUI",
(grepl("RAPE", prison$Most.Serious.Crime) |
grepl("CRIM SEX ACT", prison$Most.Serious.Crime) |
grepl("SEX", prison$Most.Serious.Crime) |
grepl("PORN", prison$Most.Serious.Crime) |
grepl("PROSTI", prison$Most.Serious.Crime) |
grepl("INDEC", prison$Most.Serious.Crime) |
grepl("SODOMY", prison$Most.Serious.Crime)) == "TRUE" ~ "Sexual Crime" ,
(grepl("BURGLARY", prison$Most.Serious.Crime) |
grepl("LARCEN", prison$Most.Serious.Crime) |
grepl("LAR", prison$Most.Serious.Crime) |
grepl("STOLEN", prison$Most.Serious.Crime) |
grepl("ROBBERY", prison$Most.Serious.Crime)) == "TRUE" ~ "Theft",
TRUE ~ as.character(prison$Most.Serious.Crime)
)
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
head(20)
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
head(21:40)
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
head(-50)
unique(prison$Crime.Category)
unique(prison$Crime.Category)
length(unique(prison$Most.Serious.Crime))
length(unique(prison$Most.Serious.Crime))
unique(prison$Crime.Category)
length(unique(prison$Crime.Category))
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
head(50)
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
View()
prison$Crime.Category <- case_when(
grepl("MURDER", prison$Most.Serious.Crime) == "TRUE" ~ "Murder",
grepl("MURDER", prison$Most.Serious.Crime) == "TRUE" ~ "Murder",
grepl("FORGE", prison$Most.Serious.Crime) == "TRUE" ~ "Forgery",
grepl("ASSAULT", prison$Most.Serious.Crime) == "TRUE" ~ "Assault",
grepl("ARSON", prison$Most.Serious.Crime) == "TRUE" ~ "Arson",
grepl("MANSLAUG", prison$Most.Serious.Crime) == "TRUE" ~ "Manslaughter",
grepl("CONTEMPT", prison$Most.Serious.Crime) == "TRUE" ~ "Contempt",
grepl("CONSPIRACY", prison$Most.Serious.Crime) == "TRUE" ~ "Conspiracy",
grepl("TAX", prison$Most.Serious.Crime) == "TRUE" ~ "Tax Related",
grepl("STRANGUL", prison$Most.Serious.Crime) == "TRUE" ~ "Strangulation",
grepl("BAIL", prison$Most.Serious.Crime) == "TRUE" ~ "Bail Related",
grepl("MISCHIEF", prison$Most.Serious.Crime) == "TRUE" ~ "Criminal Mischief",
grepl("KIDNAPPING", prison$Most.Serious.Crime) == "TRUE" ~ "Kidnapping",
grepl("COERC", prison$Most.Serious.Crime) == "TRUE" ~ "Coercion",
grepl("RECK ENDANG", prison$Most.Serious.Crime) == "TRUE" ~ "Reckless Endangerment",
grepl("UNLICENSED D", prison$Most.Serious.Crime) == "TRUE" ~ "Unlicensed Driver",
grepl("CONTRAB", prison$Most.Serious.Crime) == "TRUE" ~ "Contraband Possession",
# Weapons
(grepl("WEAP", prison$Most.Serious.Crime) |
grepl("FIREARM", prison$Most.Serious.Crime)) == "TRUE" ~ "Weapon Related",
# Fraud, identity theft
(grepl("IDENTITY THEFT", prison$Most.Serious.Crime) |
grepl("FRAUD", prison$Most.Serious.Crime)) == "TRUE" ~ "Fraud",
# Drug Related
(grepl("CPCS", prison$Most.Serious.Crime) |
grepl("DRUG", prison$Most.Serious.Crime) |
grepl("MARI", prison$Most.Serious.Crime) |
grepl("DRGS", prison$Most.Serious.Crime) |
grepl("CONTROLLED", prison$Most.Serious.Crime) |
grepl("METH", prison$Most.Serious.Crime) |
grepl("CSCS", prison$Most.Serious.Crime)) == "TRUE" ~ "Drug Related",
(grepl("IMPAIR", prison$Most.Serious.Crime) |
grepl("INTOX", prison$Most.Serious.Crime) |
grepl("DWI", prison$Most.Serious.Crime)) == "TRUE" ~ "DUI",
(grepl("RAPE", prison$Most.Serious.Crime) |
grepl("CRIM SEX ACT", prison$Most.Serious.Crime) |
grepl("SEX", prison$Most.Serious.Crime) |
grepl("PORN", prison$Most.Serious.Crime) |
grepl("PROSTI", prison$Most.Serious.Crime) |
grepl("INDEC", prison$Most.Serious.Crime) |
grepl("SODOMY", prison$Most.Serious.Crime)) == "TRUE" ~ "Sexual Crime" ,
(grepl("BURGLARY", prison$Most.Serious.Crime) |
grepl("LARCEN", prison$Most.Serious.Crime) |
grepl("LAR", prison$Most.Serious.Crime) |
grepl("STOLEN", prison$Most.Serious.Crime) |
grepl("ROBBERY", prison$Most.Serious.Crime)) == "TRUE" ~ "Theft",
(grepl("YO", prison$Most.Serious.Crime) |
grepl("YOUTHFUL", prison$Most.Serious.Crime)) == "TRUE" ~ "Youthful Offender",
TRUE ~ as.character(prison$Most.Serious.Crime)
)
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
View()
?top_n()
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
top_n(20)
View()
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(20)
prison$Crime.Category <- case_when(
grepl("MURDER", prison$Most.Serious.Crime) == "TRUE" ~ "Murder",
grepl("MURDER", prison$Most.Serious.Crime) == "TRUE" ~ "Murder",
grepl("FORGE", prison$Most.Serious.Crime) == "TRUE" ~ "Forgery",
grepl("ASSAULT", prison$Most.Serious.Crime) == "TRUE" ~ "Assault",
grepl("ARSON", prison$Most.Serious.Crime) == "TRUE" ~ "Arson",
grepl("CONTEMPT", prison$Most.Serious.Crime) == "TRUE" ~ "Contempt",
grepl("CONSPIRACY", prison$Most.Serious.Crime) == "TRUE" ~ "Conspiracy",
grepl("TAX", prison$Most.Serious.Crime) == "TRUE" ~ "Tax Related",
grepl("STRANGUL", prison$Most.Serious.Crime) == "TRUE" ~ "Strangulation",
grepl("BAIL", prison$Most.Serious.Crime) == "TRUE" ~ "Bail Related",
grepl("MISCHIEF", prison$Most.Serious.Crime) == "TRUE" ~ "Criminal Mischief",
grepl("KIDNAPPING", prison$Most.Serious.Crime) == "TRUE" ~ "Kidnapping",
grepl("COERC", prison$Most.Serious.Crime) == "TRUE" ~ "Coercion",
grepl("RECK ENDANG", prison$Most.Serious.Crime) == "TRUE" ~ "Reckless Endangerment",
grepl("UNLICENSED D", prison$Most.Serious.Crime) == "TRUE" ~ "Unlicensed Driver",
grepl("CONTRAB", prison$Most.Serious.Crime) == "TRUE" ~ "Contraband Possession",
# Manslaughter
(grepl("MANSLAUG", prison$Most.Serious.Crime) |
grepl("MANSL", prison$Most.Serious.Crime)) == "TRUE" ~ "Manslaughter",
# Weapons
(grepl("WEAP", prison$Most.Serious.Crime) |
grepl("FIREARM", prison$Most.Serious.Crime)) == "TRUE" ~ "Weapon Related",
# Fraud, identity theft
(grepl("IDENTITY THEFT", prison$Most.Serious.Crime) |
grepl("FRAUD", prison$Most.Serious.Crime)) == "TRUE" ~ "Fraud",
# Drug Related
(grepl("CPCS", prison$Most.Serious.Crime) |
grepl("DRUG", prison$Most.Serious.Crime) |
grepl("MARI", prison$Most.Serious.Crime) |
grepl("DRGS", prison$Most.Serious.Crime) |
grepl("CONTROLLED", prison$Most.Serious.Crime) |
grepl("METH", prison$Most.Serious.Crime) |
grepl("CSCS", prison$Most.Serious.Crime)) == "TRUE" ~ "Drug Related",
# DUI
(grepl("IMPAIR", prison$Most.Serious.Crime) |
grepl("INTOX", prison$Most.Serious.Crime) |
grepl("DWI", prison$Most.Serious.Crime)) == "TRUE" ~ "DUI",
# Sexual Crimes
(grepl("RAPE", prison$Most.Serious.Crime) |
grepl("CRIM SEX ACT", prison$Most.Serious.Crime) |
grepl("SEX", prison$Most.Serious.Crime) |
grepl("PORN", prison$Most.Serious.Crime) |
grepl("PROSTI", prison$Most.Serious.Crime) |
grepl("INDEC", prison$Most.Serious.Crime) |
grepl("SODOMY", prison$Most.Serious.Crime)) == "TRUE" ~ "Sexual Crime" ,
# Theft
(grepl("BURGLARY", prison$Most.Serious.Crime) |
grepl("LARCEN", prison$Most.Serious.Crime) |
grepl("LAR", prison$Most.Serious.Crime) |
grepl("STOLEN", prison$Most.Serious.Crime) |
grepl("ROBBERY", prison$Most.Serious.Crime)) == "TRUE" ~ "Theft",
# Youthful
(grepl("YO", prison$Most.Serious.Crime) |
grepl("YOUTHFUL", prison$Most.Serious.Crime)) == "TRUE" ~ "Youthful Offender",
TRUE ~ as.character(prison$Most.Serious.Crime)
)
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(20)
runApp()
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(20)
crimes <-
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(20)
crimes
crimes <-
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(20)
crimes
runApp()
?selectizeInput()
runApp()
runApp()
runApp()
View(Crimes)
View(crimes)
crimes %>%
ggplot(aes(x = Crime.Category, y = Count)) +
geom_col(stat='identity')
crimes %>%
ggplot(aes(x = Crime.Category, y = Count)) +
geom_col(stat='identity')
facet_grid(. ~ Crime.Type)
crimes %>%
ggplot(aes(x = Crime.Category, y = Count)) +
geom_col() +
facet_grid(. ~ Crime.Type) +
labs(title='Top 20 Crimes', x='Offense', y='Occurences')
crimes %>%
ggplot(aes(x = Crime.Category, y = Count)) +
geom_col() +
facet_grid(. ~ Crime.Category) +
labs(title='Top 20 Crimes', x='Offense', y='Occurences')
crimes %>%
ggplot(aes(x = Crime.Category, y = Count)) +
geom_col()
crimes %>%
ggplot(aes(x = Crime.Category, y = Count)) +
geom_col() +
facet_grid(. ~ Crime.Category)
crimes %>%
ggplot(aes(x = Crime.Category, y = Count)) +
geom_col() +
labs(title='Top 20 Crimes', x='Offense', y='Occurences')
crimes %>%
ggplot(aes(x = Crime.Category, y = Count)) +
geom_col() +
labs(title='Top 20 Crimes', x='Offense', y='Occurences') +
scale_fill_brewer(palette = 'Set1')
crimes %>%
ggplot(aes(x = Crime.Category, y = Count)) +
geom_col() +
labs(title='Top 20 Crimes', x='Offense', y='Occurences') +
scale_fill_brewer(palette = 'Set1') +
theme_bw()
crimes %>%
ggplot(aes(x = Crime.Category, y = Count)) +
geom_col() +
labs(title='Top 20 Crimes', x='Offense', y='Occurences') +
scale_fill_brewer(palette = 'Set1') +
theme_bw() +
theme(legend.key=element_blank(), legend.position="bottom") +
coord_flip()
View
?reorder()
crimes %>%
ggplot(aes(x = reordered(Crime.Category,desc(Count)), y = Count)) +
geom_col() +
labs(title='Top 20 Crimes', x='Offense', y='Occurences') +
scale_fill_brewer(palette = 'Set1') +
theme_bw() +
theme(legend.key=element_blank(), legend.position="bottom") +
coord_flip()
ggplot(aes(x = reorder(Crime.Category,desc(Count)), y = Count)) +
geom_col() +
labs(title='Top 20 Crimes', x='Offense', y='Occurences') +
scale_fill_brewer(palette = 'Set1') +
theme_bw() +
theme(legend.key=element_blank(), legend.position="bottom") +
coord_flip()
crimes %>%
ggplot(aes(reorder(Crime.Category,Count), y = Count)) +
geom_col() +
labs(title='Top 20 Crimes', x='Offense', y='Occurences') +
scale_fill_brewer(palette = 'Set1') +
theme_bw() +
theme(legend.key=element_blank(), legend.position="bottom") +
coord_flip()
runApp()
prison %>%
#filter(Year == input$crimeyear) %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(20) +
ggplot(aes(reorder(Crime.Category,Count), y = Count)) +
geom_col() +
labs(title='Top 20 Crimes', x='Offense', y='Occurences') +
scale_fill_brewer(palette = 'Set1') +
theme_bw() +
theme(legend.key=element_blank(), legend.position="bottom") +
coord_flip()
runApp()
runApp()
?infoBox
runApp()
