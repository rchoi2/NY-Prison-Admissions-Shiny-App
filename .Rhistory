# 2
bartlett.test(PlantGrowth$weight~ PlantGrowth$group)
summary(aov(PlantGrowth$weight ~ PlantGrowth$group))
View(PlantGrowth)
bartlett.test(PlantGrowth$weight~ PlantGrowth$group)
PlantGrowth %>%
ggplot(aes(x = group, y = weight )) +
geom_boxplot() +
theme_bw() +
scale_fill_brewer()
?bootstrap()
bartlett.test(PlantGrowth$weight~ PlantGrowth$group)
summary(aov(PlantGrowth$weight ~ PlantGrowth$group))
?mosaicplot
mosaicplot(HairEyeColor, shade = TRUE)
View(HairEyeColor)
mosaicplot(HairEyeColor, shade = TRUE)
library(tidyverse)
HairEyeColor %>%
group_by(Hair, Eye) %>%
summarise(total = sum(Freq))
HairEyeColor %>%
group_by(Hair, Eye) %>%
summarise(total = sum(Freq)
as.data.frame(HairEyeColor)
mosaicplot(HairEyeColor, shade = TRUE)
class(HairEyeColor)
HairEyeColor %>% filter(Sex == "Female", Hair == "Brown", Eye = c("Brown", "Blue"))
data = HairEyeColor
HairEyeColor %>%
filter(Sex == "Female", Hair == "Brown", Eye = c("Brown", "Blue"))
library(tidyverse)
HairEyeColor %>%
filter(Sex == "Female", Hair == "Brown", Eye = c("Brown", "Blue"))
library(dplyr)
HairEyeColor %>%
filter(Sex == "Female", Hair == "Brown", Eye = c("Brown", "Blue"))
hec2 <- HairEyeColor %>%
filter(Sex == "Female", Hair == "Brown", Eye = c("Brown", "Blue"))
data('HairEyeColor')
hec2 <- HairEyeColor %>%
filter(Sex == "Female", Hair == "Brown", Eye = c("Brown", "Blue"))
data.frame(HairEyeColor)
HEC <- data.frame(HairEyeColor)
hec2 <- HEC %>%
filter(Sex == "Female", Hair == "Brown", Eye = c("Brown", "Blue"))
hec2 <- HEC %>%
filter(Sex == "Female", Hair == "Brown", Eye == c("Brown", "Blue"))
hec2
hec2 %>%  head()
hec2 <- HEC %>%
filter(Sex == "Female", Hair == "Brown", Eye == "Brown" | Eye == "Blue")
hec2 %>% head()
hec2 <- HEC %>%
filter(Sex == "Female", Hair == "Brown", Eye == "Brown" | Eye == "Blue")
mosaicplot(hec2, shade = T)
mosaicplot(hec2)
hec2
mosaicplot(hec2)
mosaicplot(HairEyeColor, shade = TRUE)
hec2 <- HEC %>%
filter(Sex == "Female", Hair == "Brown")
hec2 <- HEC %>%
filter(Sex == "Female", Eye == "Brown" | Eye == "Blue")
hec2
mosaicplot(hec2)
setwd("~/Desktop/Shiny Project/prison")
shiny::runApp()
runApp()
runApp()
runApp()
prison %>%
filter(Year == as.numeric(input$totalyear)) %>%
group_by(Year, Month) %>%
summarise(Total = n())
runApp()
colnames
colnames(prison)
View(iris_unsplit)
runApp()
?checkboxGroupInput()
runApp()
runApp()
?dataTableOutput()
runApp()
runApp()
runApp()
runApp()
runApp()
prison %>%
filter(Age.Group == "Juvenile" & Year == 2018) %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(5)
prison %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(20) %>%
ggplot(aes(reorder(Crime.Category,Count), y = Count)) +
geom_col() +
labs(title='Top 20 Crimes', x='Offense', y='Occurences') +
scale_fill_brewer(palette = 'Set1') +
theme_bw() +
theme(legend.key=element_blank(), legend.position="bottom") +
coord_flip()
runApp()
prison %>%
filter(Age.Group == "Juvenile" & Year == 2018) %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(5)
prison %>%
filter(Age.Group == "Juvenile" & Year == 2018) %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(5)
prison %>%
filter(Age.Group == "Juvenile" & Year == 2018) %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(5) %>%
ggplot(aes(reorder(Crime.Category, Count), y = Count)) +
geom_col() +
scale_fill_brewer(palette = 'Set1')+
theme_bw()
prison %>%
filter(Age.Group == "Juvenile" & Year == 2018) %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(5) %>%
ggplot(aes(reorder(Crime.Category, Count), y = Count)) +
geom_col() +
scale_fill_brewer(palette = 'Set1')+
theme_bw() +
xlab("Age Group")
runApp()
prison %>%
filter(Age.Group == "Juvenile" & Year == 2018) %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(Count) %>%
top_n(5) %>%
ggplot(aes(reorder(Crime.Category, Count), y = Count)) +
geom_col() +
scale_fill_brewer(palette = 'Set1')+
theme_bw() +
xlab("Age Group")
prison %>%
filter(Age.Group == "Juvenile" & Year == 2018) %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(5) %>%
ggplot(aes(reorder(Crime.Category, Count), y = Count)) +
geom_col() +
scale_fill_brewer(palette = 'Set1')+
theme_bw() +
xlab("Age Group")
prison %>%
filter(Age.Group == "Juvenile" & Year == 2018) %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(5) %>%
ggplot(aes(reorder(Crime.Category, Count), y = Count)) +
geom_col() +
scale_fill_brewer(palette = 'Set1')+
theme_bw() +
xlab("Age Group")
prison %>%
filter(Age.Group == "Juvenile" & Year == 2018) %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count))
prison
prison$Crime.Category <- case_when(
grepl("MURDER", prison$Most.Serious.Crime) == "TRUE" ~ "Murder",
grepl("MURDER", prison$Most.Serious.Crime) == "TRUE" ~ "Murder",
grepl("FORGE", prison$Most.Serious.Crime) == "TRUE" ~ "Forgery",
grepl("ASSAULT", prison$Most.Serious.Crime) == "TRUE" ~ "Assault",
grepl("ARSON", prison$Most.Serious.Crime) == "TRUE" ~ "Arson",
grepl("CONTEMPT", prison$Most.Serious.Crime) == "TRUE" ~ "Contempt",
grepl("CONSPIRACY", prison$Most.Serious.Crime) == "TRUE" ~ "Conspiracy",
grepl("TAX", prison$Most.Serious.Crime) == "TRUE" ~ "Tax Related",
grepl("STRANGUL", prison$Most.Serious.Crime) == "TRUE" ~ "Strangulation",
grepl("BAIL", prison$Most.Serious.Crime) == "TRUE" ~ "Bail Related",
grepl("MISCHIEF", prison$Most.Serious.Crime) == "TRUE" ~ "Criminal Mischief",
grepl("KIDNAPPING", prison$Most.Serious.Crime) == "TRUE" ~ "Kidnapping",
grepl("COERC", prison$Most.Serious.Crime) == "TRUE" ~ "Coercion",
grepl("RECK ENDANG", prison$Most.Serious.Crime) == "TRUE" ~ "Reckless Endangerment",
grepl("UNLICENSED D", prison$Most.Serious.Crime) == "TRUE" ~ "Unlicensed Driver",
grepl("CONTRAB", prison$Most.Serious.Crime) == "TRUE" ~ "Contraband Possession",
# Manslaughter
(grepl("MANSLAUG", prison$Most.Serious.Crime) |
grepl("MANSL", prison$Most.Serious.Crime)) == "TRUE" ~ "Manslaughter",
# Weapons
(grepl("WEAP", prison$Most.Serious.Crime) |
grepl("FIREARM", prison$Most.Serious.Crime)) == "TRUE" ~ "Weapon Related",
# Fraud, identity theft
(grepl("IDENTITY THEFT", prison$Most.Serious.Crime) |
grepl("FRAUD", prison$Most.Serious.Crime)) == "TRUE" ~ "Fraud",
# Drug Related
(grepl("CPCS", prison$Most.Serious.Crime) |
grepl("DRUG", prison$Most.Serious.Crime) |
grepl("MARI", prison$Most.Serious.Crime) |
grepl("DRGS", prison$Most.Serious.Crime) |
grepl("CONTROLLED", prison$Most.Serious.Crime) |
grepl("METH", prison$Most.Serious.Crime) |
grepl("CSCS", prison$Most.Serious.Crime)) == "TRUE" ~ "Drug Related",
# DUI
(grepl("IMPAIR", prison$Most.Serious.Crime) |
grepl("INTOX", prison$Most.Serious.Crime) |
grepl("DWI", prison$Most.Serious.Crime)) == "TRUE" ~ "DUI",
# Sexual Crimes
(grepl("RAPE", prison$Most.Serious.Crime) |
grepl("CRIM SEX ACT", prison$Most.Serious.Crime) |
grepl("SEX", prison$Most.Serious.Crime) |
grepl("PORN", prison$Most.Serious.Crime) |
grepl("PROSTI", prison$Most.Serious.Crime) |
grepl("INDEC", prison$Most.Serious.Crime) |
grepl("SODOMY", prison$Most.Serious.Crime)) == "TRUE" ~ "Sexual Crime" ,
# Theft
(grepl("BURGLARY", prison$Most.Serious.Crime) |
grepl("LARCEN", prison$Most.Serious.Crime) |
grepl("LAR", prison$Most.Serious.Crime) |
grepl("STOLEN", prison$Most.Serious.Crime) |
grepl("ROBBERY", prison$Most.Serious.Crime)) == "TRUE" ~ "Theft",
# Youthful
(grepl("YO", prison$Most.Serious.Crime) |
grepl("YOUTHFUL", prison$Most.Serious.Crime)) == "TRUE" ~ "Youthful Offender",
TRUE ~ as.character(prison$Most.Serious.Crime)
prison %>%
filter(Age.Group == "Juvenile" & Year == 2018) %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(5) %>%
ggplot(aes(reorder(Crime.Category, Count), y = Count)) +
geom_col() +
scale_fill_brewer(palette = 'Set1')+
theme_bw() +
xlab("Age Group")
prison
prison %>%
filter(Age.Group == "Juvenile" & Year == 2018)
prison %>%
filter(Age.Group == "Juvenile" & Year == 2018) %>%
group_by(Crime.Category)
runApp()
runApp()
prison
prison %>%
filter(Age.Group == "Juvenile" & Year == 2018) %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(5) %>%
ggplot(aes(reorder(Crime.Category, Count), y = Count)) +
geom_col() +
scale_fill_brewer(palette = 'Set1') +
theme_bw()
prison %>%
filter(Age.Group == "Juvenile" & Year == 2018) %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(Count) %>%
top_n(5) %>%
ggplot(aes(reorder(Crime.Category, Count), y = Count)) +
geom_col() +
scale_fill_brewer(palette = 'Set1') +
theme_bw()
runApp()
?top_n()
prison %>%
filter(Age.Group == input$crimeagegroup  & Year ==input$crimeageyear) %>%
group_by(Crime.Category) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(5)
runApp()
runApp()
runApp()
# County Tab
output$trendbycounty <- renderPlot(
prison %>%
filter(County == input$yrcounty) %>%
group_by(Year) %>%
summarise(Count = n()) %>%
ggplot(aes(x = Year, y = Count)) %>%
geom_line()
)
prison %>%
group_by(County) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(20)
prison %>%
group_by(County) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(20) %>%
ggplot(aes(reorder(County,Count), y = Count)) +
geom_col() +
labs(title='Top 20 Counties from 2008 to 2018', x='County', y='Occurences') +
scale_fill_brewer(palette = 'Set1') +
theme_bw() +
theme(legend.key=element_blank(), legend.position="bottom") +
coord_flip()
runApp()
runApp()
prison %>%
group_by(County) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
top_n(20) %>%
ggplot(aes(reorder(County,Count), y = Count)) +
geom_col() +
labs(title='Top 20 Counties from 2008 to 2018', x='County', y='Occurences') +
scale_fill_brewer(palette = 'Set1') +
theme_bw() +
theme(legend.key=element_blank(), legend.position="bottom") +
coord_flip()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
output$monthtrend <- renderPlot(
prison %>%
filter(Year == as.numeric(input$bymonthyear)) %>%group_by(Month) %>%
summarise(Admissions = n()) %>%
ggplot(aes(x = Month, y = Admissions)) +
geom_line()) + geom_ba
prison %>%
filter(Year == as.numeric(input$bymonthyear)) %>%
group_by(Month) %>%
summarise(Admissions = n()) %>%
ggplot(aes(x = Month, y = Admissions)) +geom_line()) + geom_ba
runApp()
prison %>%
group_by(Year, Month) %>%
summarise(Admissions = n())
prison %>%
group_by(Year, Month) %>%
summarise(Admissions = n()) %>%
ggplot() +
geom_tile(aes(x = Year, y = Month, fill = Admissions))
prison %>%
group_by(Year, Month) %>%
summarise(Admissions = n()) %>%
ggplot() +
geom_tile(aes(x = Year, y = Month, fill = Admissions)) +
scale_fill_gradient(low="white", high="blue")
output$myheatmap <- renderPlot(
prison %>%
group_by(Year, Month) %>%
summarise(Admissions = n()) %>%
ggplot() +
geom_tile(aes(x = Year, y = Month, fill = Admissions)) +
scale_fill_gradient(low="white", high="darkblue"))
prison %>%
group_by(Year, Month) %>%
summarise(Admissions = n()) %>%
ggplot() +
geom_tile(aes(x = Year, y = Month, fill = Admissions)) +
scale_fill_gradient(low="white", high="darkblue")
runApp()
runApp()
prison %>%
filter(Year == 2018)) %>% #as.numeric(input$demogyear
ggplot(aes(x = Age.Group, fill = Gender), position = "dodge") +
geom_bar()
runApp()
prison %>%
filter(Year == as.numeric(input$demoyear)) %>%
ggplot(aes(x = Age.Group, fill = Gender), position = "dodge") +
geom_bar()
prison %>%
filter(Year == as.numeric(2018)) %>%
ggplot(aes(x = Age.Group, fill = Gender), position = "dodge") +
geom_bar()
prison %>%
filter(Year == as.numeric(2018)) %>%
ggplot(aes(x = Age.Group), position = "dodge") +
geom_bar()
output$demogbar <- renderPlot(
prison %>%
filter(Year == as.numeric(2018)) %>%
ggplot(aes(x = Age.Group, fill = factor(Gender)), position = "dodge") +
geom_bar()
prison %>%
filter(Year == as.numeric(2018)) %>%
ggplot(aes(x = Age.Group, fill = factor(Gender)), position = "dodge") +
geom_bar()
prison
prison %>%
filter(Year == as.numeric(2018)) %>%
ggplot(aes(x = Age.Group, fill = factor(Gender)), position = "dodge") +
geom_bar()
prison %>%
filter(Year == as.numeric(2018)) %>%
ggplot(aes(x = Age.Group, fill = factor(Gender), position = "dodge")) +
geom_bar()
runApp()
prison %>%
filter(Year == as.numeric(2018)) %>%
ggplot(aes(x = Age.Group, fill = factor(Gender))) +
geom_bar(position = "dodge")
runApp()
prison %>%
ggplot(aes(x = Year)) +
geom_bar(aes(fill = Gender, positon = "fill"))
prison %>%
ggplot(aes(x = Year)) +
geom_bar(aes(fill = Gender, position = "fill"))
prison %>%
filter(Year == as.numeric(input$demogyear))
prison %>%
ggplot(aes(x = Year))
runApp()
prison %>%
ggplot(aes(x = Year, fill = Gender, position = "fill")) +
geom_bar(aes())
prison %>%
ggplot(aes(x = Year, fill = Gender, position = "stack")) +
geom_bar(aes())
prison %>%
filter(Year == as.numeric(input$demogyear))  %>%
group_by(Age.Group, Gender) %>%
summarise(Total = n())
prison %>%
filter(Year == as.numeric(2018))  %>%
group_by(Age.Group, Gender) %>%
summarise(Total = n())
prison %>%
filter(Year == as.numeric(2018))  %>%
group_by(Age.Group, Gender) %>%
summarise(Total = n()) %>%
ggplot(aes(x = Age.Group, fill = Gender))
prison %>%
filter(Year == as.numeric(2018))  %>%
group_by(Age.Group, Gender) %>%
summarise(Total = n()) %>%
ggplot(aes(x = Age.Group, fill = Gender)) +
geom_bar(position = "dodge")
)
prison %>%
filter(Year == as.numeric(2018))  %>%
group_by(Age.Group) %>%
summarise(Total = n())
prison %>%
filter(Year == as.numeric(2018))  %>%
group_by(Age.Group) %>%
summarise(Total = n()) %>%
ggplot(aes(x = Age.Group, fill = Gender)) +
geom_bar(position = "dodge")
prison %>%
filter(Year == as.numeric(2018))  %>%
group_by(Age.Group) %>%
ggplot(aes(x = Age.Group, fill = Gender)) +
geom_bar(position = "dodge")
prison %>%
ggplot(aes(x = Year, fill = Gender, position = "stack")) +
geom_bar(aes())
prison %>%
ggplot(aes(x = Year, fill = Gender, position = "stack")) +
geom_bar(aes(stat = "identity")
prison %>%
group_by(Age.Group, Gender) %>%
summarise(Total = n())
prison %>%
group_by(Year, Gender) %>%
summarise(Total = n())
prison %>%
group_by(Year,Age.Group, Gender) %>%
summarise(Total = n()) %>%
ggplot(aes(x = Year, fill = Gender, position = "stack")) +
geom_bar(aes(stat = "identity"))
prison %>%
group_by(Year,Age.Group, Gender) %>%
summarise(Total = n()) %>%
ggplot(aes(x = Year, fill = Gender, position = "stack")) +
geom_bar(aes())
prison %>%
ggplot(aes(x = Year)) +
geom_bar(aes(fill = Gender), position = "fill")
prison %>%
filter(Year == as.numeric(input$demogyear)) %>%
ggplot(aes(x = Age.Group, fill = Gender)) +
geom_bar(position = "dodge")
runApp()
runApp()
prison %>%
ggplot(aes(x = Year)) +
geom_bar(aes(fill = Age.Group), positon = "fill"))
prison %>%
ggplot(aes(x = Year)) +
geom_bar(aes(fill = Age.Group), position = "fill"))
prison %>%
ggplot(aes(x = Year)) +
geom_bar(aes(fill = Age.Group), position = "fill")
runApp()
runApp()
?p()
